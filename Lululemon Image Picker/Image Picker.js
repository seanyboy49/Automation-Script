// Rememeber original unitsvar originalUnit = app.preferences.rulerUnits;// $.writeln ( "thisLine");// Create a new 300x600 document and assign to var// var doc = app.documents.add(300,600);// Get root folder pathvar rootPath = Folder($.fileName).path;// Open the Template psd file openPSDFile(rootPath, "/Templates.psd")// Get path to folder of selectsvar imagePath = Folder(rootPath+"/selects");// Get all images in arrayvar fileList = imagePath.getFiles(/\.(jpg)$/i);// Open first imagevar select = open(fileList[0]);function openPSDFile(relativePath, fileToOpen) {  var okToContinue=true;       // =======================================================  var idOpn = charIDToTypeID( "Opn " );  var desc231 = new ActionDescriptor();  var idnull = charIDToTypeID( "null" );  // This is the file that contins the base layout for the 3Device. Other PSD files (defined in the CSV file (Left , Middle and Right) are refered to by using Linked Smart Objects. These files  // are to be maintained by the designer.  // does file exist ? if not, then write error  if (File(relativePath+fileToOpen).exists) {  //                        $.writeln("File " + relativePath+fileToOpen +" opening");  // code from the Photoshop Listner  desc231.putPath( idnull, new File( relativePath+fileToOpen) );  var idAs = charIDToTypeID( "As  " );  var desc232 = new ActionDescriptor();  var idmaximizeCompatibility = stringIDToTypeID( "maximizeCompatibility" );  desc232.putBoolean( idmaximizeCompatibility, true );  var idPhtthree = charIDToTypeID( "Pht3" );  desc231.putObject( idAs, idPhtthree, desc232 );  var idDocI = charIDToTypeID( "DocI" );  desc231.putInteger( idDocI, 613 );  executeAction( idOpn, desc231, DialogModes.NO );  // } else {      $.writeln("File " + relativePath+fileToOpen +" does not exist, IGNORED");      okToContinue = false;   }  return okToContinue;}function openSmartObject(){  var idslct = charIDToTypeID( "slct" );  var desc606 = new ActionDescriptor();  var idnull = charIDToTypeID( "null" );  var ref179 = new ActionReference();  var idLyr = charIDToTypeID( "Lyr " );  ref179.putName( idLyr, "Select" );  desc606.putReference( idnull, ref179 );  var idMkVs = charIDToTypeID( "MkVs" );  desc606.putBoolean( idMkVs, false );  var idLyrI = charIDToTypeID( "LyrI" );  var list102 = new ActionList();  list102.putInteger( 26 );  desc606.putList( idLyrI, list102 );  executeAction( idslct, desc606, DialogModes.NO );}//// // select all// activeDocument.selection.selectAll();//// // copy image// activeDocument.selection.copy();//// // close image without saving because thug life// app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);//// // select the source image// activeDocument = srcDoc;//// // select the layer to replace the image// app.activeDocument.activeLayer = imageLeft;//// // paste the image// app.activeDocument.paste();// Select layer// var idslct = charIDToTypeID( "slct" );//     var desc605 = new ActionDescriptor();//     var idnull = charIDToTypeID( "null" );//         var ref178 = new ActionReference();//         var idLyr = charIDToTypeID( "Lyr " );//         ref178.putName( idLyr, "336x280" );//     desc605.putReference( idnull, ref178 );//     var idMkVs = charIDToTypeID( "MkVs" );//     desc605.putBoolean( idMkVs, false );//     var idLyrI = charIDToTypeID( "LyrI" );//         var list101 = new ActionList();//         list101.putInteger( 15 );//     desc605.putList( idLyrI, list101 );// executeAction( idslct, desc605, DialogModes.NO );//// // Open Smart Object// var idslct = charIDToTypeID( "slct" );//     var desc606 = new ActionDescriptor();//     var idnull = charIDToTypeID( "null" );//         var ref179 = new ActionReference();//         var idLyr = charIDToTypeID( "Lyr " );//         ref179.putName( idLyr, "Select2" );//     desc606.putReference( idnull, ref179 );//     var idMkVs = charIDToTypeID( "MkVs" );//     desc606.putBoolean( idMkVs, false );//     var idLyrI = charIDToTypeID( "LyrI" );//         var list102 = new ActionList();//         list102.putInteger( 26 );//     desc606.putList( idLyrI, list102 );// executeAction( idslct, desc606, DialogModes.NO );//// // Paste new image// var idpast = charIDToTypeID( "past" );//     var desc609 = new ActionDescriptor();//     var idAntA = charIDToTypeID( "AntA" );//     var idAnnt = charIDToTypeID( "Annt" );//     var idAnno = charIDToTypeID( "Anno" );//     desc609.putEnumerated( idAntA, idAnnt, idAnno );//     var idAs = charIDToTypeID( "As  " );//     var idPxel = charIDToTypeID( "Pxel" );//     desc609.putClass( idAs, idPxel );// executeAction( idpast, desc609, DialogModes.NO );